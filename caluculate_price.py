from GUIhelper import GUIhelper
import csv
from station import Station


'''
    MRT_PRICES
'''

#                M1                  M2  ..
mrt_stations = ["mrt_blue_hua_lamphong", "mrt_blue_sam_yan", "mrt_blue_silom", "mrt_blue_lumphini", "mrt_blue_khlong_toei", "mrt_blue_queen_sirikit_national_convention_centre",
                "mrt_blue_sukhumvit", "mrt_blue_phetchaburi", "mrt_blue_phra_ram_9", "mrt_blue_thailand_cultural_centre", "mrt_blue_huai_khwang", "mrt_blue_sutthisan",
                "mrt_blue_ratchadapisak", "mrt_blue_lat_phrao", "mrt_blue_phahon_yothin", "mrt_blue_chatuchak_park", "mrt_blue_kamphaeng_phet", "mrt_blue_bang_sue",
                "mrt_tao_poon", "mrt_purple_bang_son", "mrt_purple_wong_sawang", "mrt_purple_yaek_tiwanon", "mrt_purple_ministry_of_public_health", "mrt_purple_nonthaburi_clinic_centre",
                "mrt_purple_bang_krasor", "mrt_purple_yaek_nonthaburi_1", "mrt_purple_phra_nang_klao_bridge", "mrt_purple_sai_ma", "mrt_purple_bang_rak_noi_tha_it", "mrt_purple_bang_rak_yai",
                "mrt_purple_bang_phu", "mrt_purple_sam_yaek_bang_yai", "mrt_purple_talad_bang_yai", "mrt_purple_khlong_bang_phai"]

#               0   1   2
#              M1  M2  M3  M4  M5  M6  M7  M8  M9 M10 M11 M12 M13 M14 M15 M16 M17 M18 TAO  P2  P3  P4  P5  P6  P7  P8  P9 P10 P11 P12 P13 P14 P15 P16
mrt_prices = [[16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 37, 39, 42, 42, 42, 42, 42, 42, 42, 45, 48, 51, 53, 56, 58, 60, 63, 66, 69, 70, 70, 70, 70, 70],
              [16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 37, 39, 42, 42, 42, 42, 42, 42, 45, 48, 51, 53, 56, 58, 60, 63, 66, 69, 70, 70, 70, 70, 70],
              [19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 37, 39, 42, 42, 42, 42, 42, 45, 48, 51, 53, 56, 58, 60, 63, 66, 69, 70, 70, 70, 70, 70],
              [21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 37, 39, 42, 42, 42, 42, 45, 48, 51, 53, 56, 58, 60, 63, 66, 69, 70, 70, 70, 70, 70],
              [23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 37, 39, 42, 42, 42, 45, 48, 51, 53, 56, 58, 60, 63, 66, 69, 70, 70, 70, 70, 70],
              [25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 37, 39, 42, 42, 45, 48, 51, 53, 56, 58, 60, 63, 66, 69, 70, 70, 70, 70, 70],
              [28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 37, 39, 42, 45, 48, 51, 53, 56, 58, 60, 63, 66, 69, 70, 70, 70, 70, 70],
              [30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 37, 39, 42, 45, 48, 50, 53, 55, 57, 60, 63, 66, 67, 67, 67, 67, 67],
              [32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 37, 40, 43, 46, 48, 51, 53, 55, 58, 61, 64, 65, 65, 65, 65, 65],
              [35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 38, 41, 44, 46, 49, 51, 53, 56, 59, 62, 63, 63, 63, 63, 63],
              [37, 35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 32, 35, 38, 41, 43, 46, 48, 50, 53, 56, 59, 60, 60, 60, 60, 60],
              [39, 37, 35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 30, 33, 36, 39, 41, 44, 46, 48, 51, 54, 57, 58, 58, 58, 58, 58],
              [42, 39, 37, 35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 31, 34, 37, 39, 42, 44, 46, 49, 52, 55, 56, 56, 56, 56, 56],
              [42, 42, 39, 37, 35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 25, 28, 31, 34, 36, 39, 41, 43, 46, 49, 52, 53, 53, 53, 53, 53],
              [42, 42, 42, 39, 37, 35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 23, 26, 29, 32, 34, 37, 39, 41, 44, 47, 50, 51, 51, 51, 51, 51],
              [42, 42, 42, 42, 39, 37, 35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 21, 24, 27, 30, 32, 35, 37, 39, 42, 45, 48, 49, 49, 49, 49, 49],
              [42, 42, 42, 42, 42, 39, 37, 35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 22, 25, 27, 30, 32, 34, 37, 40, 43, 46, 47, 47, 47, 47, 47],
              [42, 42, 42, 42, 42, 42, 39, 37, 35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 16, 19, 22, 25, 27, 30, 32, 34, 37, 40, 43, 44, 44, 44, 44, 44],
              [42, 42, 42, 42, 42, 42, 42, 39, 37, 35, 32, 30, 28, 25, 23, 21, 19, 16, 16, 17, 20, 23, 25, 28, 30, 32, 35, 38, 41, 42, 42, 42, 42, 42],
              [45, 45, 45, 45, 45, 45, 45, 42, 40, 38, 35, 33, 31, 28, 26, 24, 22, 19, 17, 14, 17, 20, 22, 25, 27, 29, 32, 35, 38, 40, 42, 42, 42, 42],
              [48, 48, 48, 48, 48, 48, 48, 45, 43, 41, 38, 36, 34, 31, 29, 27, 25, 22, 20, 17, 14, 17, 19, 22, 24, 26, 29, 32, 35, 37, 39, 42, 42, 42],
              [51, 51, 51, 51, 51, 51, 51, 48, 46, 44, 41, 39, 37, 34, 32, 30, 28, 25, 23, 20, 17, 14, 16, 19, 21, 23, 26, 29, 32, 34, 36, 39, 42, 42],
              [53, 53, 53, 53, 53, 53, 53, 50, 48, 46, 43, 41, 39, 36, 34, 32, 30, 27, 25, 22, 19, 16, 14, 17, 19, 21, 24, 27, 30, 32, 34, 37, 40, 42],
              [56, 56, 56, 56, 56, 56, 56, 53, 51, 49, 46, 44, 42, 39, 37, 35, 33, 30, 28, 25, 22, 19, 17, 14, 16, 18, 21, 24, 27, 29, 31, 34, 37, 40],
              [58, 58, 58, 58, 58, 58, 58, 55, 53, 51, 48, 46, 44, 41, 39, 37, 35, 32, 30, 27, 24, 21, 19, 16, 14, 16, 19, 22, 25, 27, 29, 32, 35, 38],
              [60, 60, 60, 60, 60, 60, 60, 57, 55, 53, 50, 48, 46, 43, 41, 39, 37, 34, 32, 29, 26, 23, 21, 18, 16, 14, 17, 20, 23, 25, 27, 30, 33, 36],
              [63, 63, 63, 63, 63, 63, 63, 60, 58, 56, 53, 51, 49, 46, 44, 42, 40, 37, 35, 32, 29, 26, 24, 21, 19, 17, 14, 17, 20, 22, 24, 27, 30, 33],
              [66, 66, 66, 66, 66, 66, 66, 63, 61, 59, 56, 54, 52, 49, 47, 45, 43, 40, 38, 35, 32, 29, 27, 24, 22, 20, 17, 14, 17, 19, 21, 24, 27, 30],
              [69, 69, 69, 69, 69, 69, 69, 66, 64, 62, 59, 57, 55, 52, 50, 48, 46, 43, 41, 38, 35, 32, 30, 27, 25, 23, 20, 17, 14, 16, 18, 21, 24, 27],
              [70, 70, 70, 70, 70, 70, 70, 67, 65, 63, 60, 58, 56, 53, 51, 49, 47, 44, 42, 40, 37, 34, 32, 29, 27, 25, 22, 19, 16, 14, 16, 19, 22, 25],
              [70, 70, 70, 70, 70, 70, 70, 67, 65, 63, 60, 58, 56, 53, 51, 49, 47, 44, 42, 42, 39, 36, 34, 31, 29, 27, 24, 21, 18, 16, 14, 17, 20, 23],
              [70, 70, 70, 70, 70, 70, 70, 67, 65, 63, 60, 58, 56, 53, 51, 49, 47, 44, 42, 42, 42, 39, 37, 34, 32, 30, 27, 24, 21, 19, 17, 14, 17, 20],
              [70, 70, 70, 70, 70, 70, 70, 67, 65, 63, 60, 58, 56, 53, 51, 49, 47, 44, 42, 42, 42, 42, 40, 37, 35, 33, 30, 27, 24, 22, 20, 17, 14, 17],
              [70, 70, 70, 70, 70, 70, 70, 67, 65, 63, 60, 58, 56, 53, 51, 49, 47, 44, 42, 42, 42, 42, 42, 40, 38, 36, 33, 30, 27, 25, 23, 20, 17, 14]]

'''
    BTS
'''

bts_stations = ["bts_sukhumvit_mo_chit", "bts_sukhumvit_saphan_khwai", "bts_sukhumvit_ari", "bts_sukhumvit_sanam_pao", "bts_sukhumvit_victory_monument",
                "bts_sukhumvit_phaya_thai", "bts_sukhumvit_ratchathewi", "bts_siam",
                "bts_sukhumvit_chit_lom", "bts_sukhumvit_phloen_chit", "bts_sukhumvit_nana", "bts_sukhumvit_asok", "bts_sukhumvit_phrom_phong",
                "bts_sukhumvit_thong_lo", "bts_sukhumvit_ekkamai", "bts_sukhumvit_phra_khanong", "bts_sukhumvit_on_nut", "bts_sukhumvit_bang_chak",
                "bts_sukhumvit_punnawithi", "bts_sukhumvit_udom_suk", "bts_sukhumvit_bang_na", "bts_sukhumvit_bearing", "bts_sukhumvit_samrong",
                "bts_silom_national_stadium", "bts_silom_ratchadamri", "bts_silom_sala_daeng", "bts_silom_chong_nonsi", "bts_silom_surasak",
                "bts_silom_saphan_taksin", "bts_silom_krung_thon_buri", "bts_silom_wongwian_yai", "bts_silom_pho_nimit", "bts_silom_talat_phlu",
                "bts_silom_wutthakat", "bts_silom_bang_wa"]

#              N8  N7  N5  N4  N3  N2  N1 CEN  E1  E2  E3  E4  E5  E6  E7  E8  E9 E10 E11 E12 E13 E14 E15  W1  S1  S2  S3  S5  S6  S7  S8  S9 S10 S11 S12
bts_prices = [[16, 16, 26, 30, 33, 37, 40, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59],
              [16, 16, 23, 26, 30, 33, 37, 40, 44, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59],
              [26, 23, 16, 16, 23, 26, 30, 33, 37, 40, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 37, 37, 40, 44, 44, 44, 44, 44, 59, 59, 59, 59],
              [30, 26, 16, 16, 16, 23, 26, 30, 33, 37, 40, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 33, 33, 37, 40, 44, 44, 44, 44, 59, 59, 59, 59],
              [33, 30, 23, 16, 16, 16, 23, 26, 30, 33, 37, 40, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 30, 30, 33, 37, 44, 44, 44, 44, 59, 59, 59, 59],
              [37, 33, 26, 23, 16, 16, 16, 23, 26, 30, 33, 37, 40, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 26, 26, 30, 33, 40, 44, 44, 44, 59, 59, 59, 59],
              [40, 37, 30, 26, 23, 16, 16, 16, 23, 26, 30, 33, 37, 40, 44, 44, 44, 59, 59, 59, 59, 59, 59, 23, 23, 26, 30, 37, 40, 44, 44, 59, 59, 59, 59],
              [44, 40, 33, 30, 26, 23, 16, 16, 16, 23, 26, 30, 33, 37, 40, 44, 44, 59, 59, 59, 59, 59, 59, 16, 16, 23, 26, 33, 37, 40, 44, 59, 59, 59, 59],
              [44, 44, 37, 33, 30, 26, 23, 16, 16, 16, 23, 26, 30, 33, 37, 40, 44, 59, 59, 59, 59, 59, 59, 23, 23, 26, 30, 37, 40, 44, 44, 59, 59, 59, 59],
              [44, 44, 40, 37, 33, 30, 26, 23, 16, 16, 16, 23, 26, 30, 33, 37, 40, 55, 55, 55, 55, 55, 55, 26, 26, 30, 33, 40, 44, 44, 44, 59, 59, 59, 59],
              [44, 44, 44, 40, 37, 33, 30, 26, 23, 16, 16, 16, 23, 26, 30, 33, 37, 52, 52, 52, 52, 52, 52, 30, 30, 33, 37, 44, 44, 44, 44, 59, 59, 59, 59],
              [44, 44, 44, 44, 40, 37, 33, 30, 26, 23, 16, 16, 16, 23, 26, 30, 33, 48, 48, 48, 48, 48, 48, 33, 33, 37, 40, 44, 44, 44, 44, 59, 59, 59, 59],
              [44, 44, 44, 44, 44, 40, 37, 33, 30, 26, 23, 16, 16, 16, 23, 26, 30, 45, 45, 45, 45, 45, 45, 37, 37, 40, 44, 44, 44, 44, 44, 59, 59, 59, 59],
              [44, 44, 44, 44, 44, 44, 40, 37, 33, 30, 26, 23, 16, 16, 16, 23, 26, 41, 41, 41, 41, 41, 41, 40, 40, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59],
              [44, 44, 44, 44, 44, 44, 44, 40, 37, 33, 30, 26, 23, 16, 16, 16, 23, 38, 38, 38, 38, 38, 38, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59],
              [44, 44, 44, 44, 44, 44, 44, 44, 40, 37, 33, 30, 26, 23, 16, 16, 16, 31, 31, 31, 31, 31, 31, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59],
              [44, 44, 44, 44, 44, 44, 44, 44, 44, 40, 37, 33, 30, 26, 23, 16, 16, 15, 15, 15, 15, 15, 15, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 45, 41, 38, 31, 15, 15, 15, 15, 15, 15, 15, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 45, 41, 38, 31, 15, 15, 15, 15, 15, 15, 15, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 45, 41, 38, 31, 15, 15, 15, 15, 15, 15, 15, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 45, 41, 38, 31, 15, 15, 15, 15, 15, 15, 15, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 45, 41, 38, 31, 15, 15, 15, 15, 15, 15,  0, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 45, 41, 38, 31, 15, 15, 15, 15, 15,  0,  0, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59],
              [44, 44, 37, 33, 30, 26, 23, 16, 23, 26, 30, 33, 37, 40, 44, 44, 44, 59, 59, 59, 59, 59, 59, 16, 23, 26, 30, 37, 40, 44, 44, 59, 59, 59, 59],
              [44, 44, 37, 33, 30, 26, 23, 16, 23, 26, 30, 33, 37, 40, 44, 44, 44, 59, 59, 59, 59, 59, 59, 23, 16, 16, 23, 30, 33, 37, 40, 55, 55, 55, 55],
              [44, 44, 40, 37, 33, 30, 26, 23, 26, 30, 33, 37, 40, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 26, 16, 16, 16, 26, 30, 33, 37, 52, 52, 52, 52],
              [44, 44, 44, 44, 40, 37, 33, 30, 33, 37, 40, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 33, 26, 23, 16, 16, 23, 26, 30, 45, 45, 45, 45],
              [44, 44, 44, 44, 44, 40, 37, 33, 37, 40, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 37, 30, 26, 23, 16, 16, 23, 26, 41, 41, 41, 41],
              [44, 44, 44, 44, 44, 44, 40, 37, 40, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 40, 33, 30, 26, 16, 16, 16, 16, 31, 31, 31, 31],
              [44, 44, 44, 44, 44, 44, 44, 40, 44, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 44, 37, 33, 30, 23, 16, 16, 16, 31, 31, 31, 31],
              [44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 59, 59, 59, 59, 59, 59, 44, 40, 37, 33, 26, 16, 16, 16, 15, 15, 15, 15],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 41, 31, 31, 15, 15, 15, 15, 15],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 41, 31, 31, 15, 15, 15, 15, 15],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 41, 31, 31, 15, 15, 15, 15, 15],
              [59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 55, 52, 48, 41, 31, 31, 15, 15, 15, 15, 15]]

'''
    ARL
'''

arl_prices = [0, 15, 20, 25, 30, 35, 40, 45]



def calculate_price(stations_route):
    price = 0
    prices = []
    lines = []
    lastLineName = None
    startIndex = 0
    endIndex = 0

    lastItemNum = len(stations_route) - 1

    for i, station in enumerate(stations_route):
        stationName = station.name
        thisLinePrice = 0

        if "tao_poon" in stationName:
            stationName = "mrt_tao_poon"
        elif "siam" in stationName:
            stationName = "bts_siam"

        if i == lastItemNum:
            if lastLineName == "bts":
                thisLinePrice = bts_prices[startIndex][endIndex]
            elif lastLineName == "mrt":
                thisLinePrice = mrt_prices[startIndex][endIndex]
            elif lastLineName == "arl":
                thisLinePrice = arl_prices[count]
            lines.append(lastLineName)
            prices.append(thisLinePrice)
            price += thisLinePrice

        elif station.getType() != lastLineName:
            if lastLineName != None:

                if lastLineName == "bts":
                    thisLinePrice = bts_prices[startIndex][endIndex]
                elif lastLineName == "mrt":
                    thisLinePrice = mrt_prices[startIndex][endIndex]
                elif lastLineName == "arl":
                    thisLinePrice = arl_prices[count]
                lines.append(lastLineName)
                prices.append(thisLinePrice)
                price += thisLinePrice

            lastLineName = station.getType()
            if lastLineName == "bts":
                startIndex = bts_stations.index(stationName)
                endIndex = startIndex
            elif lastLineName == "mrt":
                startIndex = mrt_stations.index(stationName)
                endIndex = startIndex

            count = 0

        else:
            if lastLineName == "bts":
                endIndex = bts_stations.index(stationName)
            elif lastLineName == "mrt":
                endIndex = mrt_stations.index(stationName)

            count += 1

    print("Sum price: " + str(price))
    print("Price list: ", prices)
    print("Line list: ", lines)

    return price

def getStationList():
    stations = []
    with open(gui_station_data, 'r') as f:
        reader = csv.reader(f)
        for row in reader:
            # print(row)
            stations.append(Station(row[0], row[1], float(row[2]), float(row[3]), int(row[4]), int(row[5])))
    # for station in stations:
    #     print(station.lng)

    return stations

gui_station_data = "ui_asset/gui_station_data.csv"

guiHelper = GUIhelper()
stations_list = getStationList()

# Setup guihelper and move to another thread
guiHelper.stations_list = stations_list

route = ["bts_sukhumvit_ratchathewi", "bts_sukhumvit_phaya_thai", "arl_phaya_thai", "arl_ratchaprarop","arl_makkasan","mrt_blue_phetchaburi", "mrt_blue_phra_ram_9"]
route_list = guiHelper.getObject(route)



calculate_price(route_list)


